// SPDX-License-Identifier: MIT
#pragma once

// Namespace all externally visible PERK-AK-5-short symbols to avoid clashes
// with other OQS algorithms (including additional PERK parameter sets).
//
// This header is force-included via the build system for every source file
// that belongs to the PERK-AK-5-short reference implementation and its glue
// layer. It ensures that both declarations and definitions are rewritten to
// the OQS-prefixed symbols, preventing duplicate symbol definitions when
// multiple variants are linked together.

#define AES256_CTR_DRBG_struct OQS_PERKAK5_SHORT_AES256_CTR_DRBG_struct
#define AES_XOF_struct OQS_PERKAK5_SHORT_AES_XOF_struct
#define DRBG_ctx OQS_PERKAK5_SHORT_DRBG_ctx
#define memset_volatile OQS_PERKAK5_SHORT_memset_volatile
#define pk_offset OQS_PERKAK5_SHORT_pk_offset

#define AES256_CTR_DRBG_Update OQS_PERKAK5_SHORT_AES256_CTR_DRBG_Update
#define AES256_ECB OQS_PERKAK5_SHORT_AES256_ECB
#define KeccakF1600_FastLoop_Absorb OQS_PERKAK5_SHORT_KeccakF1600_FastLoop_Absorb
#define KeccakP1600_12rounds_FastLoop_Absorb OQS_PERKAK5_SHORT_KeccakP1600_12rounds_FastLoop_Absorb
#define KeccakP1600_Initialize OQS_PERKAK5_SHORT_KeccakP1600_Initialize
#define KeccakP1600_AddBytes OQS_PERKAK5_SHORT_KeccakP1600_AddBytes
#define KeccakP1600_AddBytesInLane OQS_PERKAK5_SHORT_KeccakP1600_AddBytesInLane
#define KeccakP1600_AddLanes OQS_PERKAK5_SHORT_KeccakP1600_AddLanes
#define KeccakP1600_ExtractAndAddBytes OQS_PERKAK5_SHORT_KeccakP1600_ExtractAndAddBytes
#define KeccakP1600_ExtractAndAddBytesInLane OQS_PERKAK5_SHORT_KeccakP1600_ExtractAndAddBytesInLane
#define KeccakP1600_ExtractAndAddLanes OQS_PERKAK5_SHORT_KeccakP1600_ExtractAndAddLanes
#define KeccakP1600_ExtractBytes OQS_PERKAK5_SHORT_KeccakP1600_ExtractBytes
#define KeccakP1600_ExtractBytesInLane OQS_PERKAK5_SHORT_KeccakP1600_ExtractBytesInLane
#define KeccakP1600_ExtractLanes OQS_PERKAK5_SHORT_KeccakP1600_ExtractLanes
#define KeccakP1600_OverwriteBytes OQS_PERKAK5_SHORT_KeccakP1600_OverwriteBytes
#define KeccakP1600_OverwriteBytesInLane OQS_PERKAK5_SHORT_KeccakP1600_OverwriteBytesInLane
#define KeccakP1600_OverwriteLanes OQS_PERKAK5_SHORT_KeccakP1600_OverwriteLanes
#define KeccakP1600_OverwriteWithZeroes OQS_PERKAK5_SHORT_KeccakP1600_OverwriteWithZeroes
#define KeccakP1600_Permute_12rounds OQS_PERKAK5_SHORT_KeccakP1600_Permute_12rounds
#define KeccakP1600_Permute_24rounds OQS_PERKAK5_SHORT_KeccakP1600_Permute_24rounds
#define KeccakP1600_Permute_Nrounds OQS_PERKAK5_SHORT_KeccakP1600_Permute_Nrounds

#define KeccakP1600times4_AddByte OQS_PERKAK5_SHORT_KeccakP1600times4_AddByte
#define KeccakP1600times4_AddBytes OQS_PERKAK5_SHORT_KeccakP1600times4_AddBytes
#define KeccakP1600times4_AddLanesAll OQS_PERKAK5_SHORT_KeccakP1600times4_AddLanesAll
#define KeccakP1600times4_ExtractAndAddBytes OQS_PERKAK5_SHORT_KeccakP1600times4_ExtractAndAddBytes
#define KeccakP1600times4_ExtractAndAddLanesAll OQS_PERKAK5_SHORT_KeccakP1600times4_ExtractAndAddLanesAll
#define KeccakP1600times4_ExtractBytes OQS_PERKAK5_SHORT_KeccakP1600times4_ExtractBytes
#define KeccakP1600times4_ExtractLanesAll OQS_PERKAK5_SHORT_KeccakP1600times4_ExtractLanesAll
#define KeccakP1600times4_InitializeAll OQS_PERKAK5_SHORT_KeccakP1600times4_InitializeAll
#define KeccakP1600times4_OverwriteBytes OQS_PERKAK5_SHORT_KeccakP1600times4_OverwriteBytes
#define KeccakP1600times4_OverwriteLanesAll OQS_PERKAK5_SHORT_KeccakP1600times4_OverwriteLanesAll
#define KeccakP1600times4_OverwriteWithZeroes OQS_PERKAK5_SHORT_KeccakP1600times4_OverwriteWithZeroes
#define KeccakP1600times4_PermuteAll_12rounds OQS_PERKAK5_SHORT_KeccakP1600times4_PermuteAll_12rounds
#define KeccakP1600times4_PermuteAll_24rounds OQS_PERKAK5_SHORT_KeccakP1600times4_PermuteAll_24rounds
#define KeccakP1600times4_PermuteAll_4rounds OQS_PERKAK5_SHORT_KeccakP1600times4_PermuteAll_4rounds
#define KeccakP1600times4_PermuteAll_6rounds OQS_PERKAK5_SHORT_KeccakP1600times4_PermuteAll_6rounds
#define KeccakP1600times4_StaticInitialize OQS_PERKAK5_SHORT_KeccakP1600times4_StaticInitialize

#define build_ggm_tree_leaf_cmt OQS_PERKAK5_SHORT_build_ggm_tree_leaf_cmt
#define challenge_decode OQS_PERKAK5_SHORT_challenge_decode
#define check_elementary_vector OQS_PERKAK5_SHORT_check_elementary_vector
#define crypto_sign OQS_PERKAK5_SHORT_crypto_sign
#define crypto_sign_keypair OQS_PERKAK5_SHORT_crypto_sign_keypair
#define crypto_sign_open OQS_PERKAK5_SHORT_crypto_sign_open
#define expand_ggm_tree OQS_PERKAK5_SHORT_expand_ggm_tree
#define expand_partial_ggm_tree OQS_PERKAK5_SHORT_expand_partial_ggm_tree
#define gf2_12_mod OQS_PERKAK5_SHORT_gf2_12_mod
#define gf2_13_mod OQS_PERKAK5_SHORT_gf2_13_mod
#define gf2_8_mod OQS_PERKAK5_SHORT_gf2_8_mod
#define gf2_9_mod OQS_PERKAK5_SHORT_gf2_9_mod
#define gf2_q_mod OQS_PERKAK5_SHORT_gf2_q_mod
#define gf_generate_lut OQS_PERKAK5_SHORT_gf_generate_lut
#define handleErrors OQS_PERKAK5_SHORT_handleErrors
#define int32_sort OQS_PERKAK5_SHORT_int32_sort
#define open_ggm_tree OQS_PERKAK5_SHORT_open_ggm_tree
#define open_vector_commitments OQS_PERKAK5_SHORT_open_vector_commitments
#define randombytes OQS_PERKAK5_SHORT_randombytes
#define randombytes_init OQS_PERKAK5_SHORT_randombytes_init
#define read_11bit_in_64bytearray OQS_PERKAK5_SHORT_read_11bit_in_64bytearray
#define seedexpander OQS_PERKAK5_SHORT_seedexpander
#define seedexpander_init OQS_PERKAK5_SHORT_seedexpander_init
#define sig_perk_check_pkp OQS_PERKAK5_SHORT_sig_perk_check_pkp
#define sig_perk_check_zero OQS_PERKAK5_SHORT_sig_perk_check_zero
#define sig_perk_compute_h_V OQS_PERKAK5_SHORT_sig_perk_compute_h_V
#define sig_perk_compute_masked_secret OQS_PERKAK5_SHORT_sig_perk_compute_masked_secret
#define sig_perk_compute_x_prime OQS_PERKAK5_SHORT_sig_perk_compute_x_prime
#define sig_perk_compute_y OQS_PERKAK5_SHORT_sig_perk_compute_y
#define sig_perk_convert_to_vole OQS_PERKAK5_SHORT_sig_perk_convert_to_vole
#define sig_perk_embed_masked_witness OQS_PERKAK5_SHORT_sig_perk_embed_masked_witness
#define sig_perk_embed_witness OQS_PERKAK5_SHORT_sig_perk_embed_witness
#define sig_perk_expand_witness OQS_PERKAK5_SHORT_sig_perk_expand_witness
#define sig_perk_extract_bits OQS_PERKAK5_SHORT_sig_perk_extract_bits
#define sig_perk_gen_first_challenge OQS_PERKAK5_SHORT_sig_perk_gen_first_challenge
#define sig_perk_gen_second_challenge OQS_PERKAK5_SHORT_sig_perk_gen_second_challenge
#define sig_perk_gen_third_challenge OQS_PERKAK5_SHORT_sig_perk_gen_third_challenge
#define sig_perk_generate_alpha_array OQS_PERKAK5_SHORT_sig_perk_generate_alpha_array
#define sig_perk_generate_keypair OQS_PERKAK5_SHORT_sig_perk_generate_keypair
#define sig_perk_gf2_12_add OQS_PERKAK5_SHORT_sig_perk_gf2_12_add
#define sig_perk_gf2_12_mul OQS_PERKAK5_SHORT_sig_perk_gf2_12_mul
#define sig_perk_gf2_13_add OQS_PERKAK5_SHORT_sig_perk_gf2_13_add
#define sig_perk_gf2_13_mul OQS_PERKAK5_SHORT_sig_perk_gf2_13_mul
#define sig_perk_gf2_64_add OQS_PERKAK5_SHORT_sig_perk_gf2_64_add
#define sig_perk_gf2_64_elt_get_coefficient OQS_PERKAK5_SHORT_sig_perk_gf2_64_elt_get_coefficient
#define sig_perk_gf2_64_from_bytes OQS_PERKAK5_SHORT_sig_perk_gf2_64_from_bytes
#define sig_perk_gf2_64_mul OQS_PERKAK5_SHORT_sig_perk_gf2_64_mul
#define sig_perk_gf2_64_reduce OQS_PERKAK5_SHORT_sig_perk_gf2_64_reduce
#define sig_perk_gf2_64_set OQS_PERKAK5_SHORT_sig_perk_gf2_64_set
#define sig_perk_gf2_64_ur_mul OQS_PERKAK5_SHORT_sig_perk_gf2_64_ur_mul
#define sig_perk_gf2_64_ur_set OQS_PERKAK5_SHORT_sig_perk_gf2_64_ur_set
#define sig_perk_gf2_64_ur_set_zero OQS_PERKAK5_SHORT_sig_perk_gf2_64_ur_set_zero
#define sig_perk_gf2_8_add OQS_PERKAK5_SHORT_sig_perk_gf2_8_add
#define sig_perk_gf2_8_mul OQS_PERKAK5_SHORT_sig_perk_gf2_8_mul
#define sig_perk_gf2_9_add OQS_PERKAK5_SHORT_sig_perk_gf2_9_add
#define sig_perk_gf2_9_mul OQS_PERKAK5_SHORT_sig_perk_gf2_9_mul
#define sig_perk_gf2_lambda_add OQS_PERKAK5_SHORT_sig_perk_gf2_lambda_add
#define sig_perk_gf2_lambda_elt_get_coefficient OQS_PERKAK5_SHORT_sig_perk_gf2_lambda_elt_get_coefficient
#define sig_perk_gf2_lambda_elt_print OQS_PERKAK5_SHORT_sig_perk_gf2_lambda_elt_print
#define sig_perk_gf2_lambda_elt_ur_print OQS_PERKAK5_SHORT_sig_perk_gf2_lambda_elt_ur_print
#define sig_perk_gf2_lambda_from_bytes OQS_PERKAK5_SHORT_sig_perk_gf2_lambda_from_bytes
#define sig_perk_gf2_lambda_from_gf2_64 OQS_PERKAK5_SHORT_sig_perk_gf2_lambda_from_gf2_64
#define sig_perk_gf2_lambda_mul OQS_PERKAK5_SHORT_sig_perk_gf2_lambda_mul
#define sig_perk_gf2_lambda_reduce OQS_PERKAK5_SHORT_sig_perk_gf2_lambda_reduce
#define sig_perk_gf2_lambda_set OQS_PERKAK5_SHORT_sig_perk_gf2_lambda_set
#define sig_perk_gf2_lambda_elt_set OQS_PERKAK5_SHORT_sig_perk_gf2_lambda_elt_set
#define sig_perk_gf2_lambda_elt_ur_set OQS_PERKAK5_SHORT_sig_perk_gf2_lambda_elt_ur_set
#define sig_perk_gf2_lambda_elt_ur_set_zero OQS_PERKAK5_SHORT_sig_perk_gf2_lambda_elt_ur_set_zero
#define sig_perk_gf2_lambda_to_bytes OQS_PERKAK5_SHORT_sig_perk_gf2_lambda_to_bytes
#define sig_perk_gf2_lambda_ur_mul OQS_PERKAK5_SHORT_sig_perk_gf2_lambda_ur_mul
#define sig_perk_gf2_lambda_ur_set OQS_PERKAK5_SHORT_sig_perk_gf2_lambda_ur_set
#define sig_perk_gf2_lambda_ur_set_zero OQS_PERKAK5_SHORT_sig_perk_gf2_lambda_ur_set_zero
#define sig_perk_gf2_q_add OQS_PERKAK5_SHORT_sig_perk_gf2_q_add
#define sig_perk_gf2_q_inverse OQS_PERKAK5_SHORT_sig_perk_gf2_q_inverse
#define sig_perk_gf2_q_mul OQS_PERKAK5_SHORT_sig_perk_gf2_q_mul
#define sig_perk_gf2_q_square OQS_PERKAK5_SHORT_sig_perk_gf2_q_square
#define sig_perk_hash_final OQS_PERKAK5_SHORT_sig_perk_hash_final
#define sig_perk_hash_init OQS_PERKAK5_SHORT_sig_perk_hash_init
#define sig_perk_hash_times4_final OQS_PERKAK5_SHORT_sig_perk_hash_times4_final
#define sig_perk_hash_times4_init OQS_PERKAK5_SHORT_sig_perk_hash_times4_init
#define sig_perk_hash_times4_update OQS_PERKAK5_SHORT_sig_perk_hash_times4_update
#define sig_perk_hash_update OQS_PERKAK5_SHORT_sig_perk_hash_update
#define sig_perk_mat_set_random OQS_PERKAK5_SHORT_sig_perk_mat_set_random
#define sig_perk_mat_set_random_rref OQS_PERKAK5_SHORT_sig_perk_mat_set_random_rref
#define sig_perk_merge_polys OQS_PERKAK5_SHORT_sig_perk_merge_polys
#define sig_perk_perm_gen_given_random_input OQS_PERKAK5_SHORT_sig_perk_perm_gen_given_random_input
#define sig_perk_perm_inverse OQS_PERKAK5_SHORT_sig_perk_perm_inverse
#define sig_perk_perm_set_random OQS_PERKAK5_SHORT_sig_perk_perm_set_random
#define sig_perk_perm_vect_permute OQS_PERKAK5_SHORT_sig_perk_perm_vect_permute
#define sig_perk_permute_and_convert_to_vole OQS_PERKAK5_SHORT_sig_perk_permute_and_convert_to_vole
#define sig_perk_prg OQS_PERKAK5_SHORT_sig_perk_prg
#define sig_perk_prg_final OQS_PERKAK5_SHORT_sig_perk_prg_final
#define sig_perk_prg_init OQS_PERKAK5_SHORT_sig_perk_prg_init
#define sig_perk_prg_times4 OQS_PERKAK5_SHORT_sig_perk_prg_times4
#define sig_perk_prg_times4_final OQS_PERKAK5_SHORT_sig_perk_prg_times4_final
#define sig_perk_prg_times4_init OQS_PERKAK5_SHORT_sig_perk_prg_times4_init
#define sig_perk_prg_times4_update OQS_PERKAK5_SHORT_sig_perk_prg_times4_update
#define sig_perk_prg_update OQS_PERKAK5_SHORT_sig_perk_prg_update
#define sig_perk_print_share_array OQS_PERKAK5_SHORT_sig_perk_print_share_array
#define sig_perk_print_struct_check_t OQS_PERKAK5_SHORT_sig_perk_print_struct_check_t
#define sig_perk_print_struct_f_poly_t OQS_PERKAK5_SHORT_sig_perk_print_struct_f_poly_t
#define sig_perk_print_struct_share_t OQS_PERKAK5_SHORT_sig_perk_print_struct_share_t
#define sig_perk_print_struct_share_z_t OQS_PERKAK5_SHORT_sig_perk_print_struct_share_z_t
#define sig_perk_private_key_from_bytes OQS_PERKAK5_SHORT_sig_perk_private_key_from_bytes
#define sig_perk_private_key_to_bytes OQS_PERKAK5_SHORT_sig_perk_private_key_to_bytes
#define sig_perk_public_key_from_bytes OQS_PERKAK5_SHORT_sig_perk_public_key_from_bytes
#define sig_perk_public_key_to_bytes OQS_PERKAK5_SHORT_sig_perk_public_key_to_bytes
#define sig_perk_right_kernel OQS_PERKAK5_SHORT_sig_perk_right_kernel
#define sig_perk_sample_kernel_element OQS_PERKAK5_SHORT_sig_perk_sample_kernel_element
#define sig_perk_sign OQS_PERKAK5_SHORT_sig_perk_sign
#define sig_perk_signature_from_bytes OQS_PERKAK5_SHORT_sig_perk_signature_from_bytes
#define sig_perk_signature_to_bytes OQS_PERKAK5_SHORT_sig_perk_signature_to_bytes
#define sig_perk_tensor_product_to_ev OQS_PERKAK5_SHORT_sig_perk_tensor_product_to_ev
#define sig_perk_v_tensor_product_to_ev OQS_PERKAK5_SHORT_sig_perk_v_tensor_product_to_ev
#define sig_perk_verbose_print_commitments OQS_PERKAK5_SHORT_sig_perk_verbose_print_commitments
#define sig_perk_verbose_print_ctr OQS_PERKAK5_SHORT_sig_perk_verbose_print_ctr
#define sig_perk_verbose_print_f_poly_t OQS_PERKAK5_SHORT_sig_perk_verbose_print_f_poly_t
#define sig_perk_verbose_print_i_vect OQS_PERKAK5_SHORT_sig_perk_verbose_print_i_vect
#define sig_perk_verbose_print_pdecom_seeds OQS_PERKAK5_SHORT_sig_perk_verbose_print_pdecom_seeds
#define sig_perk_verbose_print_perm OQS_PERKAK5_SHORT_sig_perk_verbose_print_perm
#define sig_perk_verbose_print_sig_perk_mat_t OQS_PERKAK5_SHORT_sig_perk_verbose_print_sig_perk_mat_t
#define sig_perk_verbose_print_signature_raw OQS_PERKAK5_SHORT_sig_perk_verbose_print_signature_raw
#define sig_perk_verbose_print_string OQS_PERKAK5_SHORT_sig_perk_verbose_print_string
#define sig_perk_verbose_print_uint16_t_array OQS_PERKAK5_SHORT_sig_perk_verbose_print_uint16_t_array
#define sig_perk_verbose_print_uint8_t_array OQS_PERKAK5_SHORT_sig_perk_verbose_print_uint8_t_array
#define sig_perk_verify OQS_PERKAK5_SHORT_sig_perk_verify
#define sig_perk_verify_check_pkp OQS_PERKAK5_SHORT_sig_perk_verify_check_pkp
#define sig_perk_verify_check_zero OQS_PERKAK5_SHORT_sig_perk_verify_check_zero
#define sig_perk_verify_compute_p_columns_check OQS_PERKAK5_SHORT_sig_perk_verify_compute_p_columns_check
#define sig_perk_verify_compute_x_prime OQS_PERKAK5_SHORT_sig_perk_verify_compute_x_prime
#define sig_perk_verify_compute_y OQS_PERKAK5_SHORT_sig_perk_verify_compute_y
#define sig_perk_verify_vole_ev OQS_PERKAK5_SHORT_sig_perk_verify_vole_ev
#define sig_perk_verify_vole_permutation OQS_PERKAK5_SHORT_sig_perk_verify_vole_permutation
#define sig_perk_vole_commit OQS_PERKAK5_SHORT_sig_perk_vole_commit
#define sig_perk_vole_hash OQS_PERKAK5_SHORT_sig_perk_vole_hash
#define sig_perk_vole_permutation OQS_PERKAK5_SHORT_sig_perk_vole_permutation
#define uint32_sort OQS_PERKAK5_SHORT_uint32_sort
#define v_check_elementary_vector OQS_PERKAK5_SHORT_v_check_elementary_vector
#define vole_hash OQS_PERKAK5_SHORT_vole_hash
#define vole_reconstuct OQS_PERKAK5_SHORT_vole_reconstuct

#define Keccak_HashInitialize OQS_PERKAK5_SHORT_Keccak_HashInitialize
#define Keccak_HashInitializetimes4 OQS_PERKAK5_SHORT_Keccak_HashInitializetimes4
#define Keccak_HashUpdate OQS_PERKAK5_SHORT_Keccak_HashUpdate
#define Keccak_HashUpdatetimes4 OQS_PERKAK5_SHORT_Keccak_HashUpdatetimes4
#define Keccak_HashFinal OQS_PERKAK5_SHORT_Keccak_HashFinal
#define Keccak_HashFinaltimes4 OQS_PERKAK5_SHORT_Keccak_HashFinaltimes4
#define Keccak_HashSqueeze OQS_PERKAK5_SHORT_Keccak_HashSqueeze
#define Keccak_HashSqueezetimes4 OQS_PERKAK5_SHORT_Keccak_HashSqueezetimes4

#define KeccakWidth1600_Sponge OQS_PERKAK5_SHORT_KeccakWidth1600_Sponge
#define KeccakWidth1600_SpongeAbsorb OQS_PERKAK5_SHORT_KeccakWidth1600_SpongeAbsorb
#define KeccakWidth1600_SpongeAbsorbLastFewBits OQS_PERKAK5_SHORT_KeccakWidth1600_SpongeAbsorbLastFewBits
#define KeccakWidth1600_SpongeInitialize OQS_PERKAK5_SHORT_KeccakWidth1600_SpongeInitialize
#define KeccakWidth1600_SpongeSqueeze OQS_PERKAK5_SHORT_KeccakWidth1600_SpongeSqueeze
#define KeccakWidth1600times4_SpongeAbsorb OQS_PERKAK5_SHORT_KeccakWidth1600times4_SpongeAbsorb
#define KeccakWidth1600times4_SpongeAbsorbLastFewBits OQS_PERKAK5_SHORT_KeccakWidth1600times4_SpongeAbsorbLastFewBits
#define KeccakWidth1600times4_SpongeInitialize OQS_PERKAK5_SHORT_KeccakWidth1600times4_SpongeInitialize
#define KeccakWidth1600times4_SpongeSqueeze OQS_PERKAK5_SHORT_KeccakWidth1600times4_SpongeSqueeze

#define SHA3_224 OQS_PERKAK5_SHORT_SHA3_224
#define SHA3_256 OQS_PERKAK5_SHORT_SHA3_256
#define SHA3_384 OQS_PERKAK5_SHORT_SHA3_384
#define SHA3_512 OQS_PERKAK5_SHORT_SHA3_512
#define SHAKE128 OQS_PERKAK5_SHORT_SHAKE128
#define SHAKE256 OQS_PERKAK5_SHORT_SHAKE256
